// REQ: OFP-TECH-007, OFP-DATA-001, OFP-DATA-002, OFP-DATA-003, OFP-DATA-004, OFP-DATA-005, OFP-FLOOR-003, OFP-FLOOR-004
// Prisma-Schema f√ºr den Office Seating Planner mit Halbtags-Slots (TimeSlot).

datasource db {
  provider = "sqlite"
}

generator client {
  provider  = "prisma-client"
  output    = "../generated/prisma"
}

enum TimeSlot {
  MORNING
  AFTERNOON
}

model Employee {
  id           Int           @id @default(autoincrement())
  name         String
  initials     String
  avatarColor  String
  preferences  String?

  workSchedule WorkSchedule?
  absences     Absence[]
  assignments  Assignment[]
}

model WorkSchedule {
  id           Int      @id @default(autoincrement())
  employeeId   Int      @unique
  employee     Employee @relation(fields: [employeeId], references: [id])

  monday       Boolean  @default(true)
  mondayNote   String?
  tuesday      Boolean  @default(true)
  tuesdayNote  String?
  wednesday    Boolean  @default(true)
  wednesdayNote String?
  thursday     Boolean  @default(true)
  thursdayNote String?
  friday       Boolean  @default(true)
  fridayNote   String?
}

model Absence {
  id         Int      @id @default(autoincrement())
  employeeId Int
  employee   Employee @relation(fields: [employeeId], references: [id])

  startDate  DateTime
  endDate    DateTime
  reason     String
}

model Desk {
  id          Int          @id @default(autoincrement())
  label       String
  gridX       Int
  gridY       Int
  gridW       Int
  gridH       Int
  rotation    Int          @default(0)

  assignments Assignment[]
}

model Assignment {
  id         Int      @id @default(autoincrement())
  date       DateTime
  slot       TimeSlot

  employeeId Int
  employee   Employee @relation(fields: [employeeId], references: [id])

  deskId     Int
  desk       Desk     @relation(fields: [deskId], references: [id])

  @@unique([date, slot, employeeId])
  @@unique([date, slot, deskId])
}

